  <section>
    <h2>Job Alerts</h2>
    <div id="jobs">Loading...</div>
    <button id="linkedin-login">Login with LinkedIn</button>

    <script>
      document.getElementById('linkedin-login').addEventListener('click', function() {
        const clientId = '777qa7z9c32gly';
        const redirectUri = encodeURIComponent('https://dedoole.github.io/dedoole.io/auth/linkedin/callback');
        const state = '987654321'; // Unique identifier for CSRF protection
        const scope = 'r_liteprofile%20r_emailaddress%20w_member_social';
        const authUrl = `https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=${clientId}&redirect_uri=${redirectUri}&state=${state}&scope=${scope}`;
        window.location.href = authUrl; // Redirect to LinkedIn authorization URL
      });

      // Function to extract query parameters from URL
      function getQueryParams() {
        const params = new URLSearchParams(window.location.search);
        return {
          code: params.get('code'),
          state: params.get('state')
        };
      }

      async function fetchAccessToken(authCode) {
        const response = await fetch('https://www.linkedin.com/oauth/v2/accessToken', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: new URLSearchParams({
            grant_type: 'authorization_code',
            code: authCode,
            redirect_uri: 'https://dedoole.github.io/dedoole.io/auth/linkedin/callback',
            client_id: '777qa7z9c32gly',
            client_secret: 'WPL_AP1.Tjvrme4L3MatBRsx.osKeJg=='
          })
        });
        const data = await response.json();
        console.log('Access Token:', data.access_token);
        return data.access_token;
      }

      async function fetchJobAlerts(token) {
        try {
          const response = await fetch('https://api.linkedin.com/v2/jobAlerts', {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
          const data = await response.json();
          const jobsContainer = document.getElementById('jobs');
          jobsContainer.innerHTML = data.elements.map(job => `
            <div class="job-alert">
              <h3>${job.title}</h3>
              <p>${job.description}</p>
              <a href="${job.applyUrl}" target="_blank">Apply Now</a>
            </div>
          `).join('');
        } catch (error) {
          console.error('Error fetching job alerts:', error);
          const jobsContainer = document.getElementById('jobs');
          jobsContainer.innerHTML = '<p>Failed to load job alerts. Please try again later.</p>';
        }
      }

      // On page load, check if there's an authorization code in the URL
      document.addEventListener('DOMContentLoaded', async function() {
        const { code, state } = getQueryParams();
        if (code) {
          const accessToken = await fetchAccessToken(code);
          fetchJobAlerts(accessToken);
        }
      });
    </script>
  </section>
